{% extends '_base.html' %}
{% load crispy_forms_tags %}
{% load cloudinary %}

{% block extra_title %}{{ profile }}{% endblock extra_title %}

{% block content %}
<div id="profile" class="container">
    <div class="row">
        <div class="col-12 profile">
            <div class="col my-auto mx-auto avatar img-thumb">
                {% cloudinary profile.avatar.url fetch_format="auto" gravity="faces" crop="thumb" %}
            </div>
            <div class="col-8">
                <i class="page-icon fas fa-quote-left"></i>
                &nbsp;{{ profile.status }}&nbsp;
                <i class="page-icon fas fa-quote-right"></i>
            </div>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-auto">
            <!-- button for friend actions -->
            {# if not friend send friend request button else cancel friend request sent, if friend request received accept or delete request if friend delete friend button or add to family #}
            <a href="{% url 'profiles:send_request' user.id %}" id="sendBtn" type="button"
                class="btn btn-outline-info"><i class="fas fa-user-plus"></i>
            </a>
            <a href="" id="cancelBtn" type="button" class="btn btn-outline-secondary"><i class="fas fa-user-minus"></i>
            </a>
            <a href="" id="acceptBtn" type="button" class="btn btn-outline-success"><i class="fas fa-user-check"></i>
            </a>
            <a href="" id="deleteBtn" type="button" class="btn btn-outline-danger"><i class="fas fa-user-times"></i>
            </a>
            <a href="" id="removeBtn" type="button" class="btn btn-outline-danger"><i class="fas fa-times"></i>
            </a>
            <a href="" id="removeBtn" type="button" class="btn btn-outline-primary"><i class="fas fa-check"></i>
            </a>
        </div>
    </div>

    {% if profile.get_friends %}
    <table class="table mt-3">
        <thead>
            <tr>
                <th scope="col">Friends</th>
                <th scope="col" class="status"></th>
                <th scope="col"></th>
            </tr>
        </thead>
        <tbody>
            {% for friend in profile.get_friends %}
            <tr>
                <td class="profile-thumb">
                    {% cloudinary friend.profile.avatar.url fetch_format="auto" gravity="faces" radius="max" crop="crop"  %}
                </td>
                <td><a href="{{ friend.profile.get_absolute_url }}">{{ friend.profile.user|title }}</a></td>
                <td class="status">{{ friend.profile.status }}</td>
                {% endfor %}
            </tr>
        </tbody>
    </table>
    {% endif %}
</div>

<h2 class="text-center">Albums: {{ albums|length }}</h2>
<div id="profile-gallery" class="row">
    {% if request.user in family %}
    <div class="col-6 portfolio">
        <h3 class="text-center">Public: {{ plc_albums|length }}</h3>
        {% for album in plc_albums %}
        <ul>
            <li>
                <span class="title"><a href="{% url 'albums:user_album' album.slug %}"">{{ album.title|title }}</a>:
                    {{ album.get_asset_count }}</span>
            </li>
        </ul>
        {% endfor %}
    </div>
    <hr>
    <div class=" col-6 portfolio">
                        <h3 class="text-center">Private: {{ pvt_albums|length }}</h3>
                        {% for album in pvt_albums %}
                        <ul>
                            <li>
                                <span class="title"><a
                                        href="{% url 'albums:user_album' album.slug %}">{{ album.title|title }}:
                                        {{ album.get_asset_count }}</a></span>
                            </li>
                        </ul>
                        {% endfor %}
    </div>
</div>
{% endif %}
{% endblock content %}